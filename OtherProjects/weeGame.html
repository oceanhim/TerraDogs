<script lang="javascript">

let OrcHealth = parseInt("100");





let WoodenSword = initWeapon("WoodenSword",1,10,0,10);
let TinSword = initWeapon("TinSword",5,15,30,20);
let IronSword = initWeapon("IronSword",15,25,50,30);
let DiamondSword = initWeapon("DiamondSword",30,50,100,60);
let PlatinumSword = initWeapon("PlatinumSword",50,100,200,135);


function initWeapon(name, minDmg, maxDmg, cost, value){
        return {
            Name : name,
            minDamage : minDmg,
            maxDamage : maxDmg,
            Cost : cost,
            SellAmount : value
        };
}

let player = {};
player.FirstName ="Altavich";
player.Health = 100;
player.Level= 1;
player.Gold = 0;
player.Strength = 5;
player.Inventory = [WoodenSword];
player.Xp = 0;
player.XpNeeded = 50;
player.ActiveWeapon = player.Inventory[0];

let Store={};
Store.Inventory = [WoodenSword, TinSword, IronSword, DiamondSword, PlatinumSword];



function getDamage(Weapon){
    return Math.floor(Math.random() * (Weapon.maxDamage - Weapon.minDamage + 1)) + Weapon.minDamage;
}
function EnoughXpToLevelUp () {
    if (player.Xp >= player.XpNeeded) {
        player.Level += 1;
        player.Gold += 10;
        player.Strength += 5
        player.Xp =0;
        player.XpNeeded = player.Level * 50
        alert (`You Leveled up! You are now Level ${player.Level}`)
    }
}

function OpenInventory () {
    console.log (player.Inventory)
}

function UseMySword () {
    let thisturnWeaponDmg = getDamage(player.ActiveWeapon);
    let thisTurnDamage = thisturnWeaponDmg + player.Strength
    
    OrcHealth -= (thisTurnDamage);
    //console.log (`the Orc's health is ${OrcHealth}`)
    if (OrcHealth <= 0) {
        player.Xp += 25;
        player.Gold += 5
        console.log("Oooh, collected 5 gold from the Orc!")
        EnoughXpToLevelUp();
        OrcHealth = player.Level * 100
        alert (`The next Orc's health is at ${OrcHealth}`)
        alert (`You now have ${player.Gold} Gold`)
    }
    console.log(`You used the ${player.ActiveWeapon.Name} to do ${thisTurnDamage} damage to the Orc, now it has ${OrcHealth} Health left`)
}

function instore () {
    Store.Inventory.find( ele => ele === item)
}


function OpenShop () {
    console.log (`Here are the items in our shop: ${Store.Inventory}`)

}

function canAfford(item){
    return player.Gold >= item.Cost;
}
function sellItem(item){
    if (player.Inventory.find( ele => ele === item)) {
        player.Inventory.pop(item);
        console.log ("Thank you, have a good day!")
        player.Gold += item.SellAmount;
        Store.Inventory.push(item);
        alert (`You got ${item.SellAmount} gold from selling your Platinum Sword`)
    }else {
        console.log ("Sorry, you don't have that.")
    }    
    console.log(`You now have ${player.Gold}`)
}
function BuyItem(item){
    if(canAfford(item) && instore(item)){
        player.Inventory.push(item); 
        player.Gold -= TinSword.Cost;
        console.log ("Here you go.")       
        Store.Inventory.pop(item); 
        player.ActiveWeapon = player.Inventory[player.Inventory.length-1]
        
    }else{
        console.log ("sorry, you don't have enough gold yet. Come back when you have enough.")
    }
    console.log(`You now have ${player.Gold}`)
}




function updateCharStats(){
    return [`Your Name: ${player.FirstName}, Health: ${player.Health}, Level: ${player.Level}, Gold: ${player.Gold}, Strength: ${player.Strength}, Active Weapon: ${player.ActiveWeapon.name}, XP: ${player.Xp} / ${player.XpNeeded}`];
}
// let CharStats = updateCharStats

function ShowStats () {
    document.getElementById("Stats").innerText=updateCharStats(); style="font-size: 200px;"
}

</script>

<html>
    <head>
    
    </head>
    <body>
        <input type="button" value="Show Stats" onclick="ShowStats()">
        <input type="button" id="WoodenSword" value="Use My Sword" onclick="UseMySword()">
        <input type="button" value="Open Shop" onclick="OpenShop()">
        <input type="button" class="PurchaseButton" id="Purchase1" value="Buy Tin Sword" onclick="BuyItem(TinSword)">
        <input type="button" value="Buy Iron Sword" onclick="BuyItem(IronSword)">
        <input type="button" value="Buy Diamond Sword" onclick="BuyItem(DiamondSword)">
        <input type="button" value="Buy Platinum Sword" onclick="BuyItem(PlatinumSword)">
        <input type="button" value="Inventory" onclick="OpenInventory()">
        <input type="button" value="Sell Tin Sword" onclick="sellItem(TinSword)">
        <input type="button" value="Sell Iron Sword" onclick="sellItem(IronSword)">
        <input type="button" value="Sell Diamond Sword" onclick="sellItem(DiamondSword)">
        <input type="button" value="Sell Platinum Sword" onclick="sellItem(PlatinumSword)">
        <div style="width: 300px; height: 300px; background-color: gray;">
            <img src="../WebsiteMaterial/images/peson.jpg" width="150px" height="150px" id="p1" />
            <img src="../WebsiteMaterial/images/orc.jpg" width="150px" height="150px" style="text-align: right;" id="opponent" />
        </div>
        <div id="Stats"></div>
    </body>
</html>
